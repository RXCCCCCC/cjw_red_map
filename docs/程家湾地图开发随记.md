# 任务
**上午：程家湾红色遗址数字测绘**

内容：走访红军医院、炮台、红军路，利用无人机航拍与全景相机采集高精度影像。

科技赋能：借无人机进行倾斜摄影，生成遗址三维模型。使用ArcGIS或腾讯地图开放平台标注遗址坐标，接入语音导览、历史图文与口述历史音频，制作程家湾红色资源数字地图（H5可交互页面）。

产出：数字地图、遗址三维建模素材。

# 程家湾红色资源数字地图

这是程家湾红色资源数字地图项目源码（前后端 + 3D Tiles 数据）。

## 概览
- 前端：Vue 3 + Vite + Pinia + Tailwind + Vant，CesiumJS 加载 3D Tiles
- 后端：Flask + SQLAlchemy (MySQL)，提供 REST API 与 3D Tiles 静态代理
- 数据：`backend/static/tiles/`（本地存放 3D Tiles），建议使用外部对象存储或 Git LFS

## 目录结构（简化）
```
cjw_red_map/
├── backend/                 # Flask 后端
│   ├── app/
│   ├── static/tiles/        # 3D Tiles（当前已移动到此处）
│   ├── requirements.txt
│   └── run.py
├── frontend/                # Vue 前端
├── 开发路线规划.md
└── 程家湾地图开发随记.md
```

## 快速启动（开发）
### 后端
1. 进入后端目录并创建数据库（首次运行）：

```bash
cd backend
# 修改 backend/app/config.py 中的 DB_* 配置为你的 MySQL 凭证（或设置环境变量）
python init_db.py
```

2. 启动后端：

```bash
python run.py
# Flask 默认监听 127.0.0.1:5000
```

### 前端
```bash
cd frontend
npm install
npm run dev
# 访问 http://localhost:5173
```

## 关于 3D Tiles 与 GitHub 发布
- 当前项目将 3D Tiles 存放在 `backend/static/tiles/`，**默认被 `.gitignore` 排除**，因为 3D Tiles 可能包含大量二进制文件（`.glb`、`.b3dm` 等），不适合直接提交到 GitHub 普通仓库。

推荐替代方案：
- 将 `backend/static/tiles/` 上传到对象存储（如阿里 OSS / 腾讯 COS / AWS S3），再把公开 URL 写入 `frontend/.env`（`VITE_TILES_BASE`），并在前端或后端使用该 URL 加载 3D Tiles。
- 或启用 Git LFS（适用于有限量的大文件），并在仓库中使用 `git lfs track "*.glb" "*.b3dm" "*.pnts"`，注意 Git LFS 有免费额度限制。

## Git 初始化与推送
仓库尚未关联远程。要推送到 GitHub：

```bash
# 在仓库根目录执行
git init
git add .
git commit -m "Initial commit: project scaffold and README"
# 添加远程仓库（替换为你的 URL）
git remote add origin git@github.com:yourname/cjw-red-map.git
git branch -M main
git push -u origin main
```

如果你想把 3D Tiles 与媒体一并托管到远程，请告诉我你希望使用 Git LFS 还是对象存储（我会生成对应步骤）。

## 我能继续帮你做的事
- 帮你把 `backend/static/tiles/` 上传到 OSS 并更新配置（需凭证或目标 URL）
- 或启用 Git LFS 并示范如何跟踪/提交大文件
- 或为仓库创建 GitHub 仓库并推送（需你授权或提供仓库 URL）

---

作者：项目助手
